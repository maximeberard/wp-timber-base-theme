{"version":3,"sources":["state.js"],"names":["State","router","link","options","previousType","previousName","navLinkClass","previousHref","window","location","href","extend","context","className","indexOf","dataHome","getAttribute","isHome","title","innerHTML","nodeType","ajaxLinkTypeAttr","objectTypeAttr","nodeName","index","Number","transition","update","page","type","name","history","replaceState","document"],"mappings":";;;;;;;;;;;;;;;;;;;;;;MA6BaA,K,WAAAA,K;AACT;;;;;;AAMA,mBAAYC,MAAZ,EAAoBC,IAApB,EAA0BC,OAA1B,EAAmC;AAAA;;AAC/B;;;;;;;;;;AAUA,WAAKA,OAAL,GAAe;AACXC,sBAAc,MADH;AAEXC,sBAAc,MAFH;AAGXC,sBAAc,UAHH;AAIXC,sBAAcC,OAAOC,QAAP,CAAgBC;AAJnB,OAAf;;AAOA,UAAIP,YAAY,IAAhB,EAAsB;AAClB,aAAKA,OAAL,GAAe,iBAAEQ,MAAF,CAAS,KAAKR,OAAd,EAAuBA,OAAvB,CAAf;AACH;;AAED,UAAMS,UAAWV,KAAKW,SAAL,CAAeC,OAAf,CAAuB,KAAKX,OAAL,CAAaG,YAApC,KAAqD,CAAtD,GAA2D,KAA3D,GAAmE,MAAnF;AACA,UAAMS,WAAWb,KAAKc,YAAL,CAAkB,cAAlB,CAAjB;AACA,UAAMC,SAAUF,YAAY,GAAb,GAAqB,IAArB,GAA8B,KAA7C;;AAEA,UAAIG,QAAQhB,KAAKc,YAAL,CAAkB,YAAlB,CAAZ;AACA,UAAGE,UAAU,EAAb,EAAiBA,QAAQhB,KAAKiB,SAAb;;AAEjB,UAAIC,WAAWlB,KAAKc,YAAL,CAAkBf,OAAOE,OAAP,CAAekB,gBAAjC,CAAf;AACA,UAAGD,aAAa,IAAb,IAAqBA,aAAa,EAArC,EAAwC;AACpC,YAAIE,iBAAiBpB,KAAKc,YAAL,CAAkBf,OAAOE,OAAP,CAAemB,cAAjC,CAArB;AACA,YAAGA,mBAAmB,IAAnB,IAA2BA,mBAAmB,EAAjD,EAAqDF,WAAWE,cAAX,CAArD,KACKF,WAAW,MAAX;AACR;;AAED;;;AAGA,WAAKF,KAAL,GAAaA,KAAb;AACA;;;AAGA,WAAKR,IAAL,GAAYR,KAAKQ,IAAjB;AACA;;;AAGA,WAAKU,QAAL,GAAgBA,QAAhB;AACA;;;AAGA,WAAKG,QAAL,GAAgBrB,KAAKc,YAAL,CAAkB,gBAAlB,CAAhB;AACA;;;AAGA,WAAKQ,KAAL,GAAaC,OAAOvB,KAAKc,YAAL,CAAkB,YAAlB,CAAP,CAAb;AACA;;;AAGA,WAAKU,UAAL,GAAkB,KAAKvB,OAAL,CAAaC,YAAb,GAA0B,MAA1B,GAAiCgB,QAAnD;AACA;;;;;;;;AAQA,WAAKR,OAAL,GAAeA,OAAf;AACA;;;AAGA,WAAKK,MAAL,GAAcA,MAAd;AACH;;AAED;;;;;;;oBAKAU,M,mBAAOC,I,EAAK;AACR,WAAKF,UAAL,GAAkB,KAAKvB,OAAL,CAAaC,YAAb,GAA0B,MAA1B,GAAiCwB,KAAKC,IAAxD;AACA,WAAKN,QAAL,GAAgBK,KAAKE,IAArB;AACA,WAAKb,MAAL,GAAcW,KAAKX,MAAnB;AACA,WAAKG,QAAL,GAAgBQ,KAAKC,IAArB;;AAEA,UAAGE,QAAQC,YAAX,EAAwB;AACpBD,gBAAQC,YAAR,CAAqB,IAArB,EAA2BC,SAASf,KAApC,EAA2CV,OAAOC,QAAP,CAAgBC,IAA3D;AACH;AACJ,K","file":"state.js","sourcesContent":["/**\n * Copyright Â© 2016, Ambroise Maupate\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is furnished\n * to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL\n * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\n * IN THE SOFTWARE.\n *\n * @file state.js\n * @author Ambroise Maupate\n */\nimport $ from \"jquery\";\n\n/**\n * State object is meant to carry informations during HTML5 History changes.\n */\nexport class State {\n    /**\n     *\n     * @param {Router} router\n     * @param {String} link\n     * @param {Object} options Extends state options.\n     */\n    constructor(router, link, options) {\n        /**\n         * Keep custom informations such as:\n         *\n         * - `previousType`: Default `\"page\"`\n         * - `previousName`: Default `\"home\"`\n         * - `navLinkClass`: Default `\"nav-link\"`\n         * - `previousHref`: Default `window.location.href`\n         *\n         * @type {Object}\n         */\n        this.options = {\n            previousType: \"page\",\n            previousName: \"home\",\n            navLinkClass: \"nav-link\",\n            previousHref: window.location.href\n        };\n\n        if (options !== null) {\n            this.options = $.extend(this.options, options);\n        }\n\n        const context = (link.className.indexOf(this.options.navLinkClass) >= 0) ? 'nav' : 'link';\n        const dataHome = link.getAttribute('data-is-home');\n        const isHome = (dataHome == '1') ? (true) : (false);\n\n        let title = link.getAttribute('data-title');\n        if(title === '') title = link.innerHTML;\n\n        let nodeType = link.getAttribute(router.options.ajaxLinkTypeAttr);\n        if(nodeType === null || nodeType === ''){\n            let objectTypeAttr = link.getAttribute(router.options.objectTypeAttr);\n            if(objectTypeAttr !== null && objectTypeAttr !== '') nodeType = objectTypeAttr;\n            else nodeType = \"page\";\n        }\n\n        /**\n         * @type {String}\n         */\n        this.title = title;\n        /**\n         * @type {String}\n         */\n        this.href = link.href;\n        /**\n         * @type {String}\n         */\n        this.nodeType = nodeType;\n        /**\n         * @type {String}\n         */\n        this.nodeName = link.getAttribute('data-node-name');\n        /**\n         * @type {Number}\n         */\n        this.index = Number(link.getAttribute('data-index'));\n        /**\n         * @type {String}\n         */\n        this.transition = this.options.previousType+'_to_'+nodeType;\n        /**\n         * History change context:\n         *\n         * - `nav`\n         * - `link`\n         *\n         * @type {String}\n         */\n        this.context = context;\n        /**\n         * @type {Boolean}\n         */\n        this.isHome = isHome;\n    }\n\n    /**\n     * Update\n     * @param  {AbstractPage} page\n     * @return {this}      \n     */\n    update(page){\n        this.transition = this.options.previousType+'_to_'+page.type;\n        this.nodeName = page.name;\n        this.isHome = page.isHome;\n        this.nodeType = page.type;\n\n        if(history.replaceState){\n            history.replaceState(this, document.title, window.location.href);\n        }\n    }\n}\n"]}